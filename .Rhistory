#Reading in the Data
library(here)
here()
#Reading in the Data
library(here)
here()
#orca_data <- read.csv(here("Project", "Raw Data", "stredulinsky2021.csv")) MADDY's Code
orca_data<- read.csv(here("stredulinsky2021.csv"))
library(here)
library(tidyverse)
library(dplyr)
#Reading in the Data
library(here)
here()
#orca_data <- read.csv(here("Project", "Raw Data", "stredulinsky2021.csv"))
# Maddy's read in
orca_data<- read.csv(here("stredulinsky2021.csv")) #Kaylie's Read in
# Exploring
head(orca_data)
glimpse(orca_data)
#okay 25 columns that is a lot.
which(is.na(orca_data))
#no NA's
#Creating Subset
orca_data_subset <- select(orca_data, Year, Group.ID, Submatriarch.ID,
HWI, CK.oa, CK.tr, CM, DPERg, DPERs, Lm, Ng,
Ns, Rg, Rsm, Sg)
head(orca_data_subset)
#Checking for Na's
which(is.na(orca_data_subset))
#okay so it appears we don't have any missing values.
orca_data_sub2 <- orca_data %>%
select(Year, Group.ID, Ag, CK.oa, CK.tr, CM, DPERg, FLg, FRg, Ng)
#selecting 6 random groups to look at because 56 is hard to see at once
groups <- sample(1:56, 6, replace = F) #sample 6 random numbers from 1-56
groups <- as.character(groups)
for(i in 1:length(groups)){ #for each number
if(nchar(groups[i])==1){ #if the number of characters is 1 (1, 2, 3...)
groups[i] <- paste("G00", groups[i], sep="") #add G00 in front
}
else{ #if the number is not 1 (10, 11, 12...)
groups[i] <- paste("G0", groups[i], sep="") #add G0 in front
}
}
orca_data_sub2_6 <- orca_data_sub2 %>% #filter for the 6 groups
filter(Group.ID == groups[1] | Group.ID == groups[2] | Group.ID == groups[3] |
Group.ID == groups[4] | Group.ID == groups[5] | Group.ID == groups[6])
#Checking number of observations from each group
orca_data_sub2 %>%
group_by(Group.ID) %>%
tally() %>%
arrange(n, desc(n))
#G002, G003 have 1 observation
#G005, G0019, G022, G024, G027, G037, G046 have 2 observations
#Year on cohesion
ggplot(data = orca_data_subset, aes(x = Year, y = HWI))+
geom_point()+
facet_wrap(~Group.ID)
# Chinook abundance on cohesion
ggplot(data = orca_data_subset, aes(x = CK.tr, y = HWI))+
geom_point()+
facet_wrap(~Group.ID)
# Maternity (by pod) on cohesion
ggplot(data = orca_data_subset, aes (x = Rg, y = HWI))+
geom_point()+
facet_wrap(~Group.ID)
#Salmon over time
ggplot(orca_data_sub2, aes(Year, CK.oa))+
geom_point()+
geom_line()
ggplot(orca_data_sub2, aes(Year, CK.tr))+
geom_point()+
geom_line()
ggplot(orca_data_sub2, aes(Year, CM))+
geom_point()+
geom_line()
#Lactating females over time in groups
ggplot(orca_data_sub2, aes(Year, FLg))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, FLg))+
geom_point()+
geom_line()+ #improves readability
facet_wrap(~Group.ID)
#Median age in groups
ggplot(orca_data_sub2, aes(Year, Ag))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, Ag))+
geom_point()+
geom_line()+ #improves readability
facet_wrap(~Group.ID)
#Number of individuals in groups
ggplot(orca_data_sub2, aes(Year, Ng))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, Ng))+
geom_point()+
geom_line()+
facet_wrap(~Group.ID)
#pod energetic requirement
ggplot(orca_data_sub2, aes(Year, DPERg))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, DPERg))+
geom_point()+
geom_line()+
facet_wrap(~Group.ID)
#Creating Subset
orca_data_subset <- select(orca_data, Year, Group.ID,
CK.oa, CK.tr, CM, DPERg, FLg, Ng)
head(orca_data_subset)
View(orca_data_subset)
orca_data_sub2 <- orca_data %>%
select(Year, Group.ID, CK.oa, CK.tr, CM, DPERg, FLg, Ng)
#selecting 6 random groups to look at because 56 is hard to see at once
groups <- sample(1:56, 6, replace = F) #sample 6 random numbers from 1-56
groups <- as.character(groups)
for(i in 1:length(groups)){ #for each number
if(nchar(groups[i])==1){ #if the number of characters is 1 (1, 2, 3...)
groups[i] <- paste("G00", groups[i], sep="") #add G00 in front
}
else{ #if the number is not 1 (10, 11, 12...)
groups[i] <- paste("G0", groups[i], sep="") #add G0 in front
}
}
orca_data_sub2_6 <- orca_data_sub2 %>% #filter for the 6 groups
filter(Group.ID == groups[1] | Group.ID == groups[2] | Group.ID == groups[3] |
Group.ID == groups[4] | Group.ID == groups[5] | Group.ID == groups[6])
#Checking number of observations from each group
orca_data_sub2 %>%
group_by(Group.ID) %>%
tally() %>%
arrange(n, desc(n))
#G002, G003 have 1 observation
#G005, G0019, G022, G024, G027, G037, G046 have 2 observations
#Salmon over time
ggplot(orca_data_sub2, aes(Year, CK.oa))+
geom_point()+
geom_line()
ggplot(orca_data_sub2, aes(Year, CK.tr))+
geom_point()+
geom_line()
ggplot(orca_data_sub2, aes(Year, CM))+
geom_point()+
geom_line()
#Lactating females over time in groups
ggplot(orca_data_sub2, aes(Year, FLg))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, FLg))+
geom_point()+
geom_line()+ #improves readability
facet_wrap(~Group.ID)
#Number of individuals in groups
ggplot(orca_data_sub2, aes(Year, Ng))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, Ng))+
geom_point()+
geom_line()+
facet_wrap(~Group.ID)
#pod energetic requirement
ggplot(orca_data_sub2, aes(Year, DPERg))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, DPERg))+
geom_point()+
geom_line()+
facet_wrap(~Group.ID)
View(orca_data)
View(orca_data_sub2)
#Creating Subset
orca_data_subset <- select(orca_data, Year, Group.ID,
CK.oa, CK.tr, CM, DPERg, FLg, FRg, Ng)
head(orca_data_subset)
#Checking for Na's
which(is.na(orca_data_subset))
#okay so it appears we don't have any missing values.
orca_data_sub2 <- orca_data %>%
select(Year, Group.ID, CK.oa, CK.tr, CM, DPERg, FLg, Ng)
#selecting 6 random groups to look at because 56 is hard to see at once
groups <- sample(1:56, 6, replace = F) #sample 6 random numbers from 1-56
groups <- as.character(groups)
for(i in 1:length(groups)){ #for each number
if(nchar(groups[i])==1){ #if the number of characters is 1 (1, 2, 3...)
groups[i] <- paste("G00", groups[i], sep="") #add G00 in front
}
else{ #if the number is not 1 (10, 11, 12...)
groups[i] <- paste("G0", groups[i], sep="") #add G0 in front
}
}
orca_data_sub2_6 <- orca_data_sub2 %>% #filter for the 6 groups
filter(Group.ID == groups[1] | Group.ID == groups[2] | Group.ID == groups[3] |
Group.ID == groups[4] | Group.ID == groups[5] | Group.ID == groups[6])
#Checking number of observations from each group
orca_data_sub2 %>%
group_by(Group.ID) %>%
tally() %>%
arrange(n, desc(n))
#G002, G003 have 1 observation
#G005, G0019, G022, G024, G027, G037, G046 have 2 observations
CK_FLg<-lmer(FLg~CK.oa, data = orca_data_sub2, REML= FALSE)
library(lme4)
library(lmerTest)
CK_FLg<-lmer(FLg~CK.oa, data = orca_data_sub2, REML= FALSE)
View(orca_data_sub2)
library(lme4)
library(lmerTest)
CK_FLg<-lmer(FLg~CK.oa+ (1|Year), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
library(lme4)
library(lmerTest)
CK_FLg<-lmer(FLg~CK.oa+ (1|Year), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
library(lme4)
library(lmerTest)
CK_FLg<-lmer(FLg~CK.oa+ (1|Year), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1|Year) + (1|Group.ID) , data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1|Year) + (1|Group.ID) , data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1|Year, Group.ID), data = orca_data_sub2, REML= FALSE)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1+Year|Group.ID), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1+Group.ID|Year), data = orca_data_sub2, REML= FALSE)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1|Year) + (1|Group.ID), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa+ (1|Year) + (1|Group.ID), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
plot(orca_data_sub2)
orca_data_sub2 %>%
select(CK.oa, Year, Group.ID) %>%
plot()
plot(CK_FLg_Year_GroupID)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa + (1|Year) + (1|Group.ID), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
par(mfrow=c(2,2))
plot(CK_FLg_Year_GroupID)
plot(CK_FLg_Year_GroupID)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa + (1|Year + Group.ID), data = orca_data_sub2, REML= FALSE)
CK_FLg_Year_GroupID<-lmer(FLg~CK.oa + (1|Year) + (1|Group.ID), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
plot(CK_FLg_Year_GroupID) # I dont know
summary (CK_FLg)
orca_data_sub2 %>%
select(Ck.oa) %>%
summary()
View(orca_data_sub2)
orca_data_sub2 %>%
select(CK.oa) %>%
summary()
orca_data_sub2 %>%
select(CK.oa) %>%
summary() %>%
plot()
orca_data_sub2 %>%
select(CK.oa) %>%
summary() %>%
hist()
orca_data_sub2 %>%
select(CK.oa) %>%
summary()
hist(orca_data_sub2$CK.oa)
hist(orca_data_sub2$FLg)
library(here)
library(tidyverse)
library(dplyr)
#Reading in the Data
library(here)
here()
#orca_data <- read.csv(here("Project", "Raw Data", "stredulinsky2021.csv"))
# Maddy's read in
orca_data<- read.csv(here("stredulinsky2021.csv")) #Kaylie's'/Clara Read in
# Exploring
head(orca_data)
glimpse(orca_data)
#okay 25 columns that is a lot.
which(is.na(orca_data))
#no NA's
#Creating Subset
orca_data_subset <- select(orca_data, Year, Group.ID,
CK.oa, CK.tr, CM, DPERg, FLg, FRg, Ng)
head(orca_data_subset)
#Checking for Na's
which(is.na(orca_data_subset))
#okay so it appears we don't have any missing values.
orca_data_sub2 <- orca_data %>%
select(Year, Group.ID, CK.oa, CK.tr, CM, DPERg, FLg, Ng)
#selecting 6 random groups to look at because 56 is hard to see at once
groups <- sample(1:56, 6, replace = F) #sample 6 random numbers from 1-56
groups <- as.character(groups)
for(i in 1:length(groups)){ #for each number
if(nchar(groups[i])==1){ #if the number of characters is 1 (1, 2, 3...)
groups[i] <- paste("G00", groups[i], sep="") #add G00 in front
}
else{ #if the number is not 1 (10, 11, 12...)
groups[i] <- paste("G0", groups[i], sep="") #add G0 in front
}
}
orca_data_sub2_6 <- orca_data_sub2 %>% #filter for the 6 groups
filter(Group.ID == groups[1] | Group.ID == groups[2] | Group.ID == groups[3] |
Group.ID == groups[4] | Group.ID == groups[5] | Group.ID == groups[6])
#Checking number of observations from each group
orca_data_sub2 %>%
group_by(Group.ID) %>%
tally() %>%
arrange(n, desc(n))
#G002, G003 have 1 observation
#G005, G0019, G022, G024, G027, G037, G046 have 2 observations
#Salmon over time
ggplot(orca_data_sub2, aes(Year, CK.oa))+
geom_point()+
geom_line()
ggplot(orca_data_sub2, aes(Year, CK.tr))+
geom_point()+
geom_line()
ggplot(orca_data_sub2, aes(Year, CM))+
geom_point()+
geom_line()
#Lactating females over time in groups
ggplot(orca_data_sub2, aes(Year, FLg))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, FLg))+
geom_point()+
geom_line()+ #improves readability
facet_wrap(~Group.ID)
#Number of individuals in groups
ggplot(orca_data_sub2, aes(Year, Ng))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, Ng))+
geom_point()+
geom_line()+
facet_wrap(~Group.ID)
#pod energetic requirement
ggplot(orca_data_sub2, aes(Year, DPERg))+
geom_point()+
facet_wrap(~Group.ID)
ggplot(orca_data_sub2_6, aes(Year, DPERg))+
geom_point()+
geom_line()+
facet_wrap(~Group.ID)
orca_data_sub2 %>%
select(CK.oa, Year, Group.ID) %>%
plot()
orca_data_sub2 %>%
select(CK.oa) %>%
summary()
hist(orca_data_sub2$CK.oa)
hist(orca_data_sub2$FLg) #Y is not normally distributed Transform to log?
library(lme4)
library(lmerTest)
CK_FLg_Year<-lmer(FLg~CK.oa+ (1|Year), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
# log transforming FLG
orca_data_sub2$FLg <- log(orca_data_sub2$FLg)
CK_FLg_Year_GroupID_logtransform<-lmer(FLg~CK.oa + (1|Year) + (1|Group.ID), data = orca_data_sub2, REML= FALSE)
#looks better!
plot(CK_FLg_Year_GroupID_logtransform)
#exponentially transforming FLG
orca_data_sub2$FLg <- exp(orca_data_sub2$FLg)
CK_FLg_Year_GroupID_exptransform<-lmer(FLg~CK.oa + (1|Year) + (1|Group.ID), data = orca_data_sub2, REML= FALSE)
#this also looks somewhat better than the original but I think the log one is a better transformation
plot(CK_FLg_Year_GroupID_exptransform)
library(lme4)
library(lmerTest)
CK_FLg_Year<-lmer(FLg~CK.oa+ (1|Year), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg)
library(lme4)
library(lmerTest)
CK_FLg_Year<-lmer(FLg~CK.oa+ (1|Year), data = orca_data_sub2, REML= FALSE)
summary (CK_FLg_Year)
?unscale
